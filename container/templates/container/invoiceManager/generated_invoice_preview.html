{% extends "container/base.html" %}

{% block content %}
<div class="container my-4">
    <h2 class="mb-4">Payment Statement - {{ current_date }}</h2>

    <form method="post" action="{% url 'paid_invoice' %}">
        {% csrf_token %}
    
        <div class="d-flex justify-content-between align-items-center flex-wrap mb-3">
            <div class="d-flex gap-2 flex-wrap align-items-center">
                <!-- 付款日期选择 -->
                <label for="payment-date" class="mb-0 fw-bold">Payment Date:</label>
                <input type="date" id="payment-date" name="payment_date" class="form-control"
                       value="{{ current_date|date:'Y-m-d' }}">
                
                <a href="{% url 'generate_invoice_pdf' %}" class="btn btn-secondary">
                    <i class="fas fa-download"></i> Download PDF
                </a>
                <button type="submit" class="btn btn-primary">Paid</button>
            </div>
    
            <div class="d-flex gap-2 flex-wrap">
                <button type="submit" class="btn btn-primary"
                        formaction="{% url 'paid_invoice_customer' %}">
                    Customer Paid
                </button>
                <a href="{% url 'invoice_unpaid' %}" class="btn btn-secondary">Back</a>
            </div>
        </div>
    
        <!-- 所有 container ID 作为隐藏字段传递 -->
        {% for container in containers %}
            <input type="hidden" name="all_ids" value="{{ container.id }}">
        {% endfor %}
    
        <!-- 表格 -->
        <div class="table-container">
            <table class="table table-bordered table-striped">
                <thead class="thead-light">
                    <tr>
                        <th>ID</th>
                        <th>Container#</th>
                        <th>Customer</th>
                        <th>Invoice#</th>
                        <th>Price</th>
                        <th>Invoice Date</th>
                        <th>Due Date</th>
                    </tr>
                </thead>
                <tbody>
                    {% for container in containers %}
                    <tr>
                        <td>{{ container.id }}</td>
                        <td>{{ container.container_id }}</td>
                        <td>{{ container.customer.name }}</td>
                        <td>{{ container.invoice_id }}</td>
                        <td>${{ container.price }}</td>
                        <td>{{ container.invoice_date|date:"m/d/Y" }}</td>
                        <td>{{ container.due_date|date:"m/d/Y" }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </form>
</div>
{% endblock %}
